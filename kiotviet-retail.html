<!DOCTYPE html><html lang="vi" class="scroll-smooth"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Game KiotViet Retail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; touch-action: manipulation; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom right, #f8fafc, #e0f2fe); overflow: hidden; }
        .soft-glow-background .shape { position: absolute; filter: blur(140px); opacity: 0.25; }
        .soft-glow-background .shape1 { height: 350px; width: 350px; background: #166def; border-radius: 50%; top: -50px; left: -100px; animation: moveInCircle 22s ease-in-out infinite; }
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        .soft-glow-background .shape2 { height: 450px; width: 450px; background: #16a34a; border-radius: 50%; bottom: -100px; right: -100px; animation: moveVertical 28s ease-in-out infinite; }
        @keyframes moveVertical { 0% { transform: translateY(-50%); } 50% { transform: translateY(50%); } 100% { transform: translateY(-50%); } }
        .kv-blue { color: #166def; } .bg-kv-blue { background-color: #166def; }
        .main-card { background-color: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(203, 213, 225, 0.5); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .fade-in { animation: fadeIn 0.5s ease-in-out; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .mode-btn { transition: all 0.2s ease; } .mode-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        .btn-selected-green { background-color: #16a34a !important; border-color: #15803d !important; color: white !important; }
        .correct { background-color: #10B981 !important; color: white !important; border-color: #059669 !important; }
        .incorrect { background-color: #EF4444 !important; color: white !important; border-color: #DC2626 !important; }
        #certificate-wrapper { width: 100%; max-width: 1100px; aspect-ratio: 16 / 9; display: flex; flex-direction: column; }
        #certificate-content { flex-grow: 1; border: 10px solid #166def; padding: clamp(1rem, 4vw, 2rem); background: linear-gradient(135deg, #ffffff 0%, #f7faff 100%); display: flex; flex-direction: column; justify-content: center; }
        .review-answer.is-correct-answer { border-left: 4px solid #10B981; background-color: #f0fdf4; }
        .review-answer.is-selected-incorrect { border-left: 4px solid #EF4444; background-color: #fef2f2; }
        .btn { font-weight: bold; padding: 0.75rem 2rem; border-radius: 0.5rem; text-align: center; transition: all 0.2s; cursor: pointer; }
        .btn-blue { background-color: #166def; color: white; } .btn-blue:hover { background-color: #0a58ca; }
        .btn-green { background-color: #16a34a; color: white; } .btn-green:hover { background-color: #15803d; }
        .btn-slate { background-color: #475569; color: white; } .btn-slate:hover { background-color: #334155; }
    </style></head><body class="text-slate-700 antialiased flex items-center justify-center min-h-screen p-4">
    <div class="soft-glow-background"><div class="shape shape1"></div><div class="shape shape2"></div></div>
    <main class="w-full max-w-2xl">
        <div id="start-screen" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 fade-in"></div>
        <div id="quiz-container" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden fade-in"></div>
        <div id="result-area" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden text-center fade-in"></div>
        <div id="review-screen" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden fade-in w-full max-w-3xl"></div>
    </main>
    <div id="certificate-screen" class="hidden fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 fade-in"></div><script>
    // --- Data Injection Placeholders (SIMPLIFIED) ---
    const quizDataForClient = [{"id":"q_1","question":"Cửa hàng tạp hóa cần tìm vị trí mặt hàng gia dụng trên kệ. Tính năng nào trên Màn hình bán hàng hỗ trợ thu ngân thực hiện điều này?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_1_1","text":"Tùy chọn hiển thị"},{"id":"a_q_1_2","text":"Chế độ nhập"},{"id":"a_q_1_3","text":"Xem chi tiết"}]},{"id":"q_2","question":"Cửa hàng mỹ phẩm cần tìm sản phẩm theo thuộc tính 'Loại da' (khô, dầu). Chế độ bán hàng nào trên KiotViet hỗ trợ tính năng này?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_2_1","text":"Bán nhanh"},{"id":"a_q_2_2","text":"Bán nhanh và Bán thường"},{"id":"a_q_2_3","text":"Bán thường"}]},{"id":"q_3","question":"Hiệu thuốc cần thêm mã sản phẩm cho thuốc mới nhập. Giao diện nào trên KiotViet cho phép thực hiện điều này?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_3_1","text":"Danh mục hàng hóa, Nhập hàng, Kiểm kho"},{"id":"a_q_3_2","text":"Màn hình bán hàng"},{"id":"a_q_3_3","text":"Trên cả Màn hình bán hàng và các giao diện Danh mục hàng hóa, Nhập hàng, Kiểm kho"}]},{"id":"q_4","question":"Tại cửa hàng tạp hóa, khi khách hàng mua nhiều mặt hàng, thu ngân có thể áp dụng giảm giá như thế nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_4_1","text":"Giảm giá cho từng sản phẩm"},{"id":"a_q_4_2","text":"Giảm giá cho toàn bộ hóa đơn"},{"id":"a_q_4_3","text":"Giảm giá cho từng sản phẩm và Giảm giá cho toàn bộ hóa đơn"}]},{"id":"q_5","question":"Trong trường hợp mất mạng Internet, cửa hàng thời trang có thể tiếp tục sử dụng phần nào của KiotViet để thực hiện giao dịch bán hàng?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_5_1","text":"Có thể sử dụng Màn hình bán hàng"},{"id":"a_q_5_2","text":"Có thể sử dụng Màn hình quản lý"},{"id":"a_q_5_3","text":"Có thể sử dụng cả Màn hình bán hàng và Màn hình quản lý"}]},{"id":"q_6","question":"Hiệu sách cần nhập mã vạch tự động trong quá trình kiểm kho. Phương pháp nào dưới đây được hỗ trợ bởi KiotViet?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_6_1","text":"Sử dụng máy quét mã vạch"},{"id":"a_q_6_2","text":"Sử dụng camera điện thoại"},{"id":"a_q_6_3","text":"Sử dụng cả máy quét mã vạch và camera điện thoại"}]},{"id":"q_7","question":"Khi cửa hàng tạp hóa thực hiện trả hàng theo hóa đơn, giá hoàn trả cho khách được phần mềm gợi ý dựa trên yếu tố nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_7_1","text":"Giá vốn của sản phẩm theo hóa đơn gốc"},{"id":"a_q_7_2","text":"Giá bán của sản phẩm tại thời điểm trả hàng"},{"id":"a_q_7_3","text":"Giá bán của sản phẩm theo hóa đơn gốc"}]},{"id":"q_8","question":"Khi cửa hàng tạp hóa trả hàng nhanh, giá hoàn trả cho khách được phần mềm gợi ý dựa trên thời điểm nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_8_1","text":"Giá vốn của sản phẩm theo hóa đơn gốc"},{"id":"a_q_8_2","text":"Giá bán của sản phẩm tại thời điểm trả hàng"},{"id":"a_q_8_3","text":"Giá bán của sản phẩm theo hóa đơn gốc"}]},{"id":"q_9","question":"Cửa hàng tạp hóa muốn xử lý một phiếu đặt hàng thành nhiều hóa đơn khác nhau. KiotViet có hỗ trợ tính năng này không?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_9_1","text":"Chỉ có thể tạo hóa đơn 1 lần duy nhất"},{"id":"a_q_9_2","text":"Chỉ có thể tạo hóa đơn tối đa 2 lần"},{"id":"a_q_9_3","text":"Có thể tạo hóa đơn nhiều lần"}]},{"id":"q_10","question":"Một cửa hàng tạp hóa cần thông báo thanh toán QR thành công qua loa máy tính để quản lý giao dịch. Ngân hàng nào có thể đáp ứng yêu cầu này?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_10_1","text":"Techcombank"},{"id":"a_q_10_2","text":"Sacombank"},{"id":"a_q_10_3","text":"Vietcombank"}]},{"id":"q_11","question":"Khi sử dụng Màn hiển thị QR F92, cửa hàng có thể phát thông báo thanh toán qua loa cho loại Ví điện tử MOMO nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_11_1","text":"Chỉ hỗ trợ Ví điện tử MOMO cá nhân"},{"id":"a_q_11_2","text":"Hỗ trợ cả Ví điện tử MOMO cá nhân và doanh nghiệp"},{"id":"a_q_11_3","text":"Chỉ hỗ trợ Ví điện tử MOMO doanh nghiệp"}]},{"id":"q_12","question":"Để phục vụ chi nhánh tại nước ngoài, KiotViet cung cấp những tính năng đặc biệt nào liên quan đến múi giờ và đơn vị tiền tệ?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_12_1","text":"Chọn múi giờ cho chi nhánh ở nước ngoài"},{"id":"a_q_12_2","text":"Sử dụng đơn vị tiền tệ khác VNĐ"},{"id":"a_q_12_3","text":"Hỗ trợ cả việc chọn múi giờ và sử dụng đơn vị tiền tệ khác VNĐ"}]},{"id":"q_13","question":"Cửa hàng tạp hóa cần phát thông báo chuyển khoản thành công qua loa. Tính năng này yêu cầu tài khoản ngân hàng thuộc danh sách nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_13_1","text":"Tất cả các ngân hàng trên thế giới"},{"id":"a_q_13_2","text":"Tất cả các ngân hàng tại Việt Nam"},{"id":"a_q_13_3","text":"Các ngân hàng có liên kết với KiotViet"}]},{"id":"q_14","question":"Để hiển thị mã QR động VietQR dựa trên thông tin hóa đơn, cửa hàng cần sử dụng tài khoản ngân hàng thuộc nhóm nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_14_1","text":"Chỉ có VIB Bank"},{"id":"a_q_14_2","text":"Tất cả các ngân hàng tại Việt Nam thuộc hệ thống Napas"},{"id":"a_q_14_3","text":"Chỉ các ngân hàng có liên kết với KiotViet"}]},{"id":"q_15","question":"Khi kết nối với các đơn vị giao vận trên KiotViet, cửa hàng tạp hóa có thể thực hiện những thao tác nào liên quan đến vận chuyển?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_15_1","text":"Xem báo giá và lựa chọn đơn vị vận chuyển"},{"id":"a_q_15_2","text":"Theo dõi tình trạng giao hàng"},{"id":"a_q_15_3","text":"Vừa xem báo giá, lựa chọn đơn vị vận chuyển, vừa theo dõi tình trạng giao hàng"}]},{"id":"q_16","question":"Khi sử dụng KiotViet Retail, cửa hàng có thể kết nối với những nhà phát hành hóa đơn điện tử nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_16_1","text":"Chỉ hỗ trợ KV eInvoice"},{"id":"a_q_16_2","text":"Chỉ hỗ trợ FPT"},{"id":"a_q_16_3","text":"Cả KV eInvoice và FPT, MISA, Viettel, VNPT"}]},{"id":"q_17","question":"Khi sử dụng KiotViet Retail, cửa hàng có thể tính thuế VAT theo những phương pháp nào?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_17_1","text":"Phương pháp khấu trừ"},{"id":"a_q_17_2","text":"Phương pháp trực tiếp"},{"id":"a_q_17_3","text":"Lựa chọn Phương pháp khấu trừ hoặc Phương pháp trực tiếp"}]},{"id":"q_18","question":"Khi áp dụng phương pháp khấu trừ, cửa hàng thời trang có thể thiết lập thuế suất VAT cho các sản phẩm ra sao?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_18_1","text":"Chỉ 1 mức thuế suất chung"},{"id":"a_q_18_2","text":"Chỉ mức VAT chuẩn là 8%"},{"id":"a_q_18_3","text":"Các sản phẩm có thể có thuế suất VAT khác nhau"}]},{"id":"q_19","question":"Khi sử dụng KiotViet, cửa hàng tạp hóa có thể in mã QR của Hóa đơn điện tử tích hợp với Hóa đơn bán hàng không? Nếu được, điều kiện là gì?","topic":"Tối ưu vận hành","answers":[{"id":"a_q_19_1","text":"Có, cần bật tính năng này trong Màn hình bán hàng"},{"id":"a_q_19_2","text":"Không, phải in riêng"},{"id":"a_q_19_3","text":"Không, phần mềm chưa hỗ trợ"}]},{"id":"q_20","question":"Để phân biệt các size áo và váy (S, M, L) trong quản lý hàng hóa, cửa hàng thời trang cần sử dụng tính năng gì trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_20_1","text":"Nhóm hàng"},{"id":"a_q_20_2","text":"Phân loại"},{"id":"a_q_20_3","text":"Thuộc tính"}]},{"id":"q_21","question":"Cửa hàng cung cấp dịch vụ giặt là cần thiết lập loại hàng hóa nào trên KiotViet để tính tiền cho dịch vụ giặt áo sơ mi?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_21_1","text":"Hàng hóa thường"},{"id":"a_q_21_2","text":"Hàng combo đóng gói"},{"id":"a_q_21_3","text":"Hàng dịch vụ"}]},{"id":"q_22","question":"Cửa hàng muốn bán giỏ quà Tết, trong đó mỗi giỏ quà gồm nhiều sản phẩm như bánh, mứt và rượu vang. Loại hàng hóa nào trên KiotViet phù hợp?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_22_1","text":"Combo - Đóng gói"},{"id":"a_q_22_2","text":"Sản xuất"},{"id":"a_q_22_3","text":"Chế biến"}]},{"id":"q_23","question":"Khi bán hàng hóa có quản lý Lô-HSD, nếu bật tùy chọn 'Gợi ý Lô HSD', hệ thống sẽ ưu tiên lựa chọn sản phẩm từ lô nào để bán?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_23_1","text":"Lô có date gần nhất"},{"id":"a_q_23_2","text":"Lô có date xa nhất"},{"id":"a_q_23_3","text":"Lô ngẫu nhiên"}]},{"id":"q_24","question":"Ngành hàng nào trên KiotViet hỗ trợ tính năng Quản lý hàng hóa theo Serial-IMEI?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_24_1","text":"Tạp hóa"},{"id":"a_q_24_2","text":"Điện thoại - Điện máy"},{"id":"a_q_24_3","text":"Tất cả các ngành hàng"}]},{"id":"q_25","question":"Khi gộp nhiều phiếu kiểm kho trên KiotViet, trạng thái của các phiếu cần gộp phải đảm bảo điều kiện nào?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_25_1","text":"Các phiếu phải ở trạng thái Phiếu tạm"},{"id":"a_q_25_2","text":"Chỉ cần 1 phiếu ở trạng thái phiếu tạm"},{"id":"a_q_25_3","text":"Các phiếu phải ở trạng thái hoàn thành"}]},{"id":"q_26","question":"Tem mã vạch của sản phẩm in từ KiotViet có thể chứa những thông tin nào dưới đây?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_26_1","text":"Chỉ Tên cửa hàng"},{"id":"a_q_26_2","text":"Chỉ Giá bán sản phẩm"},{"id":"a_q_26_3","text":"Cả tên cửa hàng và giá bán sản phẩm"}]},{"id":"q_27","question":"Để trả lại hàng hóa cho Nhà cung cấp, cửa hàng cần sử dụng giao dịch nào trong KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_27_1","text":"Đổi trả hàng"},{"id":"a_q_27_2","text":"Trả hàng"},{"id":"a_q_27_3","text":"Trả hàng nhập"}]},{"id":"q_28","question":"Cửa hàng bán đồ gia dụng cần nhập hàng với số lượng và giá khác nhau cho cùng một mã sản phẩm. Tính năng nào trên KiotViet hỗ trợ việc này?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_28_1","text":"Thêm dòng"},{"id":"a_q_28_2","text":"Thiết lập giá"},{"id":"a_q_28_3","text":"Chỉnh sửa thành tiền"}]},{"id":"q_29","question":"Khi nhập hàng, nếu cần thay đổi giá bán của sản phẩm, cửa hàng bán đồ chơi trẻ em nên sử dụng tính năng nào trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_29_1","text":"Thêm dòng"},{"id":"a_q_29_2","text":"Thiết lập giá"},{"id":"a_q_29_3","text":"Chỉnh sửa thành tiền"}]},{"id":"q_30","question":"Cửa hàng kinh doanh giày dép muốn lập phiếu thu khi khách hàng thanh toán công nợ. Họ có thể thực hiện thao tác này ở đâu trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_30_1","text":"Sổ quỹ"},{"id":"a_q_30_2","text":"Màn hình bán hàng"},{"id":"a_q_30_3","text":"Cả trên Sổ quỹ và Màn hình bán hàng"}]},{"id":"q_31","question":"Khi sử dụng tính năng Quản lý khách hàng theo người phụ trách trên KiotViet, cửa hàng có thể thực hiện những thao tác nào?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_31_1","text":"Thiết lập người phụ trách"},{"id":"a_q_31_2","text":"Giới hạn xem và giao dịch theo người phụ trách"},{"id":"a_q_31_3","text":"Vừa thiết lập, vừa giới hạn xem và giao dịch theo người phụ trách"}]},{"id":"q_32","question":"Khi sử dụng KiotViet, cửa hàng điện tử có thể quản lý riêng biệt theo từng chi nhánh đối với những đối tượng nào?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_32_1","text":"Khách hàng"},{"id":"a_q_32_2","text":"Nhà cung cấp"},{"id":"a_q_32_3","text":"Cả Khách hàng và Nhà cung cấp"}]},{"id":"q_33","question":"Để ghi nhận công nợ ban đầu của Nhà cung cấp, cửa hàng bán đồ gia dụng cần sử dụng tính năng nào trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_33_1","text":"Điều chỉnh"},{"id":"a_q_33_2","text":"Thanh toán"},{"id":"a_q_33_3","text":"Chiết khấu thanh toán"}]},{"id":"q_34","question":"Để quản lý giờ làm việc của nhân viên, cửa hàng có thể sử dụng hình thức chấm công nào được hỗ trợ bởi KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_34_1","text":"Nhận diện khuôn mặt"},{"id":"a_q_34_2","text":"Chấm công mobile qua Zalo Mini App"},{"id":"a_q_34_3","text":"Cả nhận diện khuôn mặt và chấm công mobile qua Zalo Mini App"}]},{"id":"q_35","question":"Khi sử dụng KiotViet, cửa hàng thời trang có thể dùng Sổ quỹ để làm gì?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_35_1","text":"Quản lý các giao dịch thu chi"},{"id":"a_q_35_2","text":"Tên một loại báo cáo"},{"id":"a_q_35_3","text":"Vừa là tính năng quản lý thu chi, vừa là tên một loại báo cáo"}]},{"id":"q_36","question":"Để biết tổng giá vốn và tổng giá bán của tất cả sản phẩm, cửa hàng thời trang nên xem báo cáo nào trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_36_1","text":"Báo cáo hàng hóa > Giá trị kho"},{"id":"a_q_36_2","text":"Báo cáo bán hàng > Hàng hóa"},{"id":"a_q_36_3","text":"Báo cáo cuối ngày > Tổng hợp"}]},{"id":"q_37","question":"Khi cần xem báo cáo chi tiết với nhiều cột thông tin, cửa hàng tạp hóa nên sử dụng kiểu hiển thị nào trên KiotViet?","topic":"Tối ưu quản lý","answers":[{"id":"a_q_37_1","text":"Kiểu ngang"},{"id":"a_q_37_2","text":"Kiểu dọc"},{"id":"a_q_37_3","text":"Kiểu biểu đồ"}]},{"id":"q_38","question":"Khi sử dụng KiotViet, cửa hàng tạp hóa có thể đồng bộ thông tin nào của sản phẩm lên các sàn Thương mại điện tử?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_38_1","text":"Giá bán"},{"id":"a_q_38_2","text":"Giá vốn"},{"id":"a_q_38_3","text":"Cả giá bán và giá vốn"}]},{"id":"q_39","question":"Khi kết nối KiotViet với Tiktok Shop, cửa hàng có thể khởi tạo danh mục sản phẩm trên cả hai nền tảng theo những cách nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_39_1","text":"Sao chép từ Tiktok Shop về KiotViet"},{"id":"a_q_39_2","text":"Xuất file từ KiotViet sang Tiktok Shop"},{"id":"a_q_39_3","text":"Cả sao chép từ Tiktok Shop về và xuất file từ KiotViet sang Tiktok Shop"}]},{"id":"q_40","question":"Khi sử dụng KiotViet, cửa hàng tạp hóa có thể áp dụng tính năng Tin nhắn mẫu để phản hồi khách hàng trên những mạng xã hội nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_40_1","text":"Facebook"},{"id":"a_q_40_2","text":"Instagram"},{"id":"a_q_40_3","text":"Cả Facebook và Instagram"}]},{"id":"q_41","question":"Khi sử dụng Facebook POS, cửa hàng có thể liên kết gian hàng KiotViet với nhiều Fanpage hay không?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_41_1","text":"Chỉ liên kết được 1 fanpage"},{"id":"a_q_41_2","text":"Chỉ liên kết được tối đa 5 fanpage"},{"id":"a_q_41_3","text":"Có thể liên kết nhiều fanpage"}]},{"id":"q_42","question":"Khi sử dụng màn hình Facebook POS trên KiotViet, cửa hàng có thể gửi tin nhắn xác nhận đặt hàng tự động cho khách không? Nếu có, điều kiện là gì?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_42_1","text":"Không, chỉ hỗ trợ xác nhận mua hàng"},{"id":"a_q_42_2","text":"Có, cần thiết lập “Gửi tin nhắn xác nhận đặt hàng”"},{"id":"a_q_42_3","text":"Có, cần thiết lập “Gửi tin nhắn xác nhận mua hàng”"}]},{"id":"q_43","question":"Khi livestream bán hàng, cửa hàng có thể in bình luận từ mạng xã hội nào nếu sử dụng KiotViet?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_43_1","text":"Livestream trên Fanpage Facebook"},{"id":"a_q_43_2","text":"Livestream trên Tiktok cá nhân"},{"id":"a_q_43_3","text":"Cả khi livestream trên Fanpage Facebook và Tiktok cá nhân"}]},{"id":"q_44","question":"Khi khách hàng vào xem website của một cửa hàng tạp hóa sử dụng nền tảng KiotViet Web, họ có thể thực hiện những thao tác nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_44_1","text":"Đặt hàng online"},{"id":"a_q_44_2","text":"Xem thông tin giới thiệu, liên hệ"},{"id":"a_q_44_3","text":"Vừa đặt hàng online, vừa xem thông tin giới thiệu, liên hệ"}]},{"id":"q_45","question":"Để phân tích hiệu quả kinh doanh, cửa hàng tạp hóa cần xác định sản phẩm bán chạy và bán chậm. Mục phân tích thông minh nào hỗ trợ điều này?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_45_1","text":"Phân tích kinh doanh"},{"id":"a_q_45_2","text":"Phân tích hàng hóa"},{"id":"a_q_45_3","text":"Phân tích khách hàng"}]},{"id":"q_46","question":"Khi sử dụng KiotViet, cửa hàng thời trang có thể thiết lập những loại chương trình khuyến mại nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_46_1","text":"Giảm giá theo giá trị hóa đơn"},{"id":"a_q_46_2","text":"Mua hàng tặng hàng"},{"id":"a_q_46_3","text":"Cả giảm giá theo giá trị hóa đơn và mua hàng tặng hàng"}]},{"id":"q_47","question":"Voucher trên KiotViet Retail có ý nghĩa là giảm giá theo hình thức nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_47_1","text":"VND"},{"id":"a_q_47_2","text":"%"},{"id":"a_q_47_3","text":"Có thể là VND hoặc %"}]},{"id":"q_48","question":"Coupon trên KiotViet Retail có ý nghĩa là giảm giá theo hình thức nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_48_1","text":"VND"},{"id":"a_q_48_2","text":"%"},{"id":"a_q_48_3","text":"Có thể là VND hoặc %"}]},{"id":"q_49","question":"Khi sử dụng KiotViet, cửa hàng tạp hóa có thể thiết lập tích điểm cho sản phẩm có giảm giá hay không?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_49_1","text":"Do cửa hàng thiết lập"},{"id":"a_q_49_2","text":"KiotViet luôn cho phép"},{"id":"a_q_49_3","text":"KiotViet luôn không cho phép"}]},{"id":"q_50","question":"Để gửi tin nhắn ZNS từ KiotViet Retail nhằm xác nhận mua hàng hoặc trả hàng, cửa hàng cần đảm bảo những điều kiện nào?","topic":"Thúc đẩy doanh thu","answers":[{"id":"a_q_50_1","text":"Nạp đủ tiền, còn hạn mức gửi tin"},{"id":"a_q_50_2","text":"SĐT khách hàng là số đăng ký Zalo"},{"id":"a_q_50_3","text":"Cần đảm bảo cả việc nạp đủ tiền, còn hạn mức và SĐT khách hàng là số Zalo"}]}];
    const answerKey = {"q_1":"a_q_1_3","q_2":"a_q_2_3","q_3":"a_q_3_3","q_4":"a_q_4_3","q_5":"a_q_5_1","q_6":"a_q_6_3","q_7":"a_q_7_3","q_8":"a_q_8_2","q_9":"a_q_9_3","q_10":"a_q_10_3","q_11":"a_q_11_3","q_12":"a_q_12_3","q_13":"a_q_13_3","q_14":"a_q_14_2","q_15":"a_q_15_3","q_16":"a_q_16_3","q_17":"a_q_17_3","q_18":"a_q_18_3","q_19":"a_q_19_1","q_20":"a_q_20_3","q_21":"a_q_21_3","q_22":"a_q_22_1","q_23":"a_q_23_1","q_24":"a_q_24_2","q_25":"a_q_25_1","q_26":"a_q_26_3","q_27":"a_q_27_3","q_28":"a_q_28_1","q_29":"a_q_29_2","q_30":"a_q_30_3","q_31":"a_q_31_3","q_32":"a_q_32_3","q_33":"a_q_33_1","q_34":"a_q_34_3","q_35":"a_q_35_1","q_36":"a_q_36_1","q_37":"a_q_37_1","q_38":"a_q_38_1","q_39":"a_q_39_3","q_40":"a_q_40_3","q_41":"a_q_41_3","q_42":"a_q_42_2","q_43":"a_q_43_3","q_44":"a_q_44_3","q_45":"a_q_45_2","q_46":"a_q_46_3","q_47":"a_q_47_1","q_48":"a_q_48_2","q_49":"a_q_49_1","q_50":"a_q_50_3"};
    const feedbackMessages = { incorrect: `Rất tiếc, bạn đã sai. Bạn hãy tham khảo thêm tài liệu tại <a href='https://sites.google.com/view/thuvienkiotviet/' target='_blank' class='underline text-kv-blue'>Thư viện KiotViet</a> nhé!`, fail: `Cần cố gắng hơn! Bạn hãy tham khảo thêm tài liệu tại <a href='https://sites.google.com/view/thuvienkiotviet/' target='_blank' class='underline text-kv-blue'>Thư viện KiotViet</a> nhé!` };
    
    // --- State & Global Variables ---
    let currentQuestionIndex, score, questionsForGame, gameResults, selectedMode, userInfo;
    
    const elements = {};

    function setupHTML() {
        elements.startScreen = document.getElementById('start-screen');
        elements.quizContainer = document.getElementById('quiz-container');
        elements.resultArea = document.getElementById('result-area');
        elements.reviewScreen = document.getElementById('review-screen');
        elements.certificateScreen = document.getElementById('certificate-screen');

        elements.startScreen.innerHTML = `
             <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-10 mx-auto mb-6">
             <h1 class="text-2xl sm:text-3xl font-bold text-slate-800 text-center mb-2">${document.title}</h1>
             <p class="text-slate-600 text-center mb-6">Vui lòng nhập thông tin và chọn chế độ chơi</p>
             <div class="space-y-4 mb-6">
                <div><label for="name-input" class="block text-sm font-medium text-slate-700 mb-1">Họ và tên</label><input type="text" id="name-input" class="w-full p-3 bg-white/80 border border-slate-300 rounded-lg focus:ring-2 focus:ring-kv-blue" placeholder="Nguyễn Văn A"></div>
                <div><label for="department-input" class="block text-sm font-medium text-slate-700 mb-1">Phòng ban</label><input type="text" id="department-input" class="w-full p-3 bg-white/80 border border-slate-300 rounded-lg" placeholder="TSHNI99"></div>
             </div>
             <div id="mode-selection-area" class="space-y-6"></div>
             <p id="error-message" class="text-red-500 text-center mt-4 h-5"></p>
             <button id="start-btn" class="w-full mt-4 btn btn-blue text-lg">Bắt đầu</button>`;
        
        elements.quizContainer.innerHTML = `
            <div class="flex justify-between items-center mb-4">
                <div class="text-sm font-semibold text-slate-600"><span id="question-count"></span></div>
                <div id="score-display" class="text-lg font-bold text-kv-blue">Điểm: 0</div>
            </div>
            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-kv-blue h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <p id="question-text" class="text-xl font-semibold text-slate-800 mb-6 min-h-[84px]"></p>
            <div id="answers-container" class="space-y-3"></div>
            <div id="feedback-area" class="mt-6 text-center"></div>
            <button id="next-btn" class="hidden w-full mt-6 btn btn-green text-lg">Câu tiếp theo</button>`;

        elements.resultArea.innerHTML = `
            <h2 id="result-title" class="text-3xl font-bold text-slate-800 mb-4">Hoàn thành!</h2>
            <p id="score-text" class="text-xl text-slate-600 mb-6"></p>
            <div id="fail-message" class="hidden text-lg text-red-600 font-semibold mb-6">${feedbackMessages.fail}</div>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                 <button id="review-btn" class="btn btn-slate">Xem lại đáp án</button>
                 <button id="certificate-btn" class="hidden btn btn-green">Xem giấy khen</button>
                 <button id="restart-btn" class="btn btn-blue">Chơi lại</button>
            </div>`;
        
        elements.reviewScreen.innerHTML = `
            <h2 class="text-2xl font-bold text-slate-800 text-center mb-6">Xem Lại Kết Quả</h2>
            <div id="review-container" class="space-y-6 max-h-[60vh] overflow-y-auto pr-2"></div>
            <div class="mt-8 flex flex-col sm:flex-row justify-center gap-4">
                <button id="certificate-btn-from-review" class="hidden btn btn-green">Xem giấy khen</button>
                <button id="restart-from-review-btn" class="btn btn-blue">Chơi lại</button>
            </div>`;

        elements.certificateScreen.innerHTML = `
            <div id="certificate-wrapper">
                <div id="certificate-content">
                    <div class="text-center">
                        <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8 sm:h-10 mx-auto mb-4">
                        <h1 class="text-2xl sm:text-4xl font-bold text-kv-blue" style="font-family: 'Times New Roman', serif;">GIẤY CHỨNG NHẬN</h1>
                        <p class="text-base sm:text-lg mt-4">Trân trọng trao cho</p>
                        <p id="cert-name" class="text-xl sm:text-3xl font-bold text-slate-800 my-4 border-b-2 border-slate-300 pb-2"></p>
                        <p id="cert-department" class="text-base sm:text-lg font-medium text-slate-600 -mt-2 mb-4"></p>
                        <p class="text-base sm:text-lg">Đã xuất sắc hoàn thành bài kiểm tra</p>
                        <p id="cert-quiz-name" class="text-lg sm:text-xl font-semibold my-2 text-slate-700"></p>
                        <p class="text-base sm:text-lg">Với số điểm</p>
                        <p id="cert-score" class="text-3xl sm:text-4xl font-bold text-green-600 my-4"></p>
                        <p class="text-xs sm:text-sm text-slate-500">Ngày hoàn thành: <span id="cert-date"></span></p>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row justify-center gap-4 mt-4">
                    <button id="review-btn-from-cert" class="btn btn-slate">Xem lại đáp án</button>
                    <button id="close-cert-btn" class="btn btn-blue">Đóng</button>
                </div>
            </div>`;
    }

    function cacheElements() {
        const ids = [
            'name-input', 'department-input', 'mode-selection-area', 'error-message', 'start-btn',
            'question-count', 'score-display', 'progress-bar', 'question-text', 'answers-container',
            'feedback-area', 'next-btn', 'result-title', 'score-text', 'fail-message', 'review-btn',
            'certificate-btn', 'restart-btn', 'review-container', 'certificate-btn-from-review',
            'restart-from-review-btn', 'certificate-wrapper', 'cert-name', 'cert-department',
            'cert-quiz-name', 'cert-score', 'cert-date', 'review-btn-from-cert', 'close-cert-btn'
        ];
        ids.forEach(id => {
            elements[id.replace(/-(\w)/g, (m, p1) => p1.toUpperCase())] = document.getElementById(id);
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        setupHTML();
        cacheElements();
        if (!answerKey || !quizDataForClient) {
            document.body.innerHTML = `<p style='font-family: sans-serif; text-align: center; margin-top: 50px; font-size: 1.2rem; color: #b91c1c;'>Lỗi nghiêm trọng: Dữ liệu trò chơi bị hỏng.</p>`;
            return;
        }
        setupModeSelection();
        addEventListeners();
        resetGame();
    });
    
    function setupModeSelection() {
        const topics = [...new Set(quizDataForClient.map(q => q.topic))].filter(Boolean);
        let html = `
            <div id="random-mode-group">
                <p class="font-semibold text-slate-800 text-center mb-3">Chơi ngẫu nhiên</p>
                <div class="flex flex-wrap justify-center gap-3">
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="5">5 câu</button>
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="30">30 câu</button>
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="all">Toàn bộ (${quizDataForClient.length} câu)</button>
                </div>
            </div>`;
        if (topics.length > 0) {
            html += `
                <div id="topic-mode-group" class="mt-6">
                    <p class="font-semibold text-slate-800 text-center mb-3">Chơi theo chủ đề (10 câu)</p>
                    <div class="flex flex-wrap justify-center gap-3">
                        ${topics.map(topic => `<button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="topic" data-topic="${topic}">${topic}</button>`).join('')}
                    </div>
                </div>`;
        }
        elements.modeSelectionArea.innerHTML = html;
        
        document.querySelectorAll('.mode-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('btn-selected-green'));
                e.currentTarget.classList.add('btn-selected-green');
                selectedMode = e.currentTarget.dataset;
            });
        });
    }

    function addEventListeners() {
        elements.startBtn.addEventListener('click', startGame);
        elements.nextBtn.addEventListener('click', nextQuestion);
        elements.restartBtn.addEventListener('click', resetGame);
        elements.restartFromReviewBtn.addEventListener('click', resetGame);
        elements.reviewBtn.addEventListener('click', showReview);
        elements.certificateBtn.addEventListener('click', showCertificate);
        elements.closeCertBtn.addEventListener('click', closeCertificate);
        elements.certificateBtnFromReview.addEventListener('click', showCertificate);
        elements.reviewBtnFromCert.addEventListener('click', showReview);
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && !elements.certificateScreen.classList.contains('hidden')) {
                showScreen('resultArea');
            }
        });
    }

    function showScreen(screenKey) {
        ['startScreen', 'quizContainer', 'resultArea', 'reviewScreen', 'certificateScreen'].forEach(key => {
            elements[key].classList.add('hidden');
        });
        elements[screenKey].classList.remove('hidden');
        document.querySelector('main').style.display = (screenKey === 'certificateScreen') ? 'none' : 'block';
    }

    function startGame() {
        userInfo = { name: elements.nameInput.value.trim(), department: elements.departmentInput.value.trim() };
        if (!userInfo.name || !userInfo.department) {
            elements.errorMessage.innerText = 'Vui lòng điền đầy đủ Họ và tên và Phòng ban.'; return;
        }
        if (!selectedMode || !selectedMode.mode) {
            elements.errorMessage.innerText = 'Vui lòng chọn một chế độ chơi.'; return;
        }
        elements.errorMessage.innerText = '';
        prepareQuestions();
        if (questionsForGame.length === 0) {
            elements.errorMessage.innerText = 'Không có câu hỏi cho chủ đề này.'; return;
        }
        showScreen('quizContainer');
        showQuestion();
    }

    function prepareQuestions() {
        let source = [...quizDataForClient];
        if (selectedMode.mode === 'topic') {
            source = source.filter(q => q.topic === selectedMode.topic);
            source = shuffleArray(source);
            questionsForGame = source.slice(0, 10);
        } else {
            source = shuffleArray(source);
            if (selectedMode.count && selectedMode.count !== 'all') {
                questionsForGame = source.slice(0, parseInt(selectedMode.count, 10));
            } else { questionsForGame = source; }
        }
    }

    function showQuestion() {
        elements.feedbackArea.innerHTML = '';
        elements.nextBtn.classList.add('hidden');
        const q = questionsForGame[currentQuestionIndex];
        elements.questionCount.innerText = `Câu ${currentQuestionIndex + 1}/${questionsForGame.length}`;
        elements.progressBar.style.width = `${((currentQuestionIndex + 1) / questionsForGame.length) * 100}%`;
        elements.questionText.innerText = q.question;
        elements.answersContainer.innerHTML = '';
        shuffleArray([...q.answers]).forEach(ans => {
            const btn = document.createElement('button');
            btn.innerHTML = `<span>${ans.text}</span>`;
            btn.className = 'w-full text-left p-4 bg-white/80 border-2 border-slate-300 rounded-lg hover:bg-blue-100 hover:border-kv-blue transition-all duration-200 flex items-center';
            btn.dataset.answerId = ans.id;
            btn.dataset.questionId = q.id;
            btn.onclick = selectAnswer;
            elements.answersContainer.appendChild(btn);
        });
    }

    function selectAnswer(e) {
        const selectedBtn = e.currentTarget;
        const { questionId, answerId } = selectedBtn.dataset;
        const isCorrect = answerId === answerKey[questionId];

        gameResults.push({
            question: questionsForGame[currentQuestionIndex],
            selectedAnswerId: answerId,
            correctAnswerId: answerKey[questionId],
            isCorrect
        });

        const feedback = document.createElement('p');
        feedback.className = 'font-medium text-lg';
        if (isCorrect) {
            score++;
            elements.scoreDisplay.innerText = `Điểm: ${score}`;
            feedback.innerHTML = '🎉 Chúc mừng bạn, đáp án hoàn toàn chính xác!';
            feedback.className += ' text-green-600';
            selectedBtn.classList.add('correct');
        } else {
            feedback.innerHTML = feedbackMessages.incorrect;
            feedback.className += ' text-red-500';
            selectedBtn.classList.add('incorrect');
        }
        elements.feedbackArea.appendChild(feedback);
        Array.from(elements.answersContainer.children).forEach(button => button.onclick = null);
        elements.nextBtn.classList.remove('hidden');
    }

    function nextQuestion() {
        currentQuestionIndex++;
        (currentQuestionIndex < questionsForGame.length) ? showQuestion() : showScore();
    }

    function showScore() {
        const percentage = (score / questionsForGame.length) * 100;
        elements.scoreText.innerText = `Bạn đã trả lời đúng ${score}/${questionsForGame.length} câu (${percentage.toFixed(0)}%)`;
        const passed = percentage >= 80;
        elements.resultTitle.innerText = passed ? "Xuất sắc!" : "Hoàn thành!";
        elements.failMessage.classList.toggle('hidden', passed);
        elements.certificateBtn.classList.toggle('hidden', !passed);
        elements.certificateBtnFromReview.classList.toggle('hidden', !passed);
        if (passed) confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
        showScreen('resultArea');
    }

    function showReview() {
        const correct = gameResults.filter(r => r.isCorrect);
        const incorrect = gameResults.filter(r => !r.isCorrect);

        const render = (results, title, isCorrectSection) => {
            if (results.length === 0) return '';
            let html = `<div class="mb-8"><h3 class="text-xl font-bold ${isCorrectSection ? 'text-green-600' : 'text-red-600'} border-b-2 pb-2 mb-4">${title} (${results.length})</h3><div class="space-y-4">`;
            results.forEach(r => {
                html += `<div class="p-4 bg-white/50 rounded-lg shadow-sm">
                    <p class="font-semibold text-slate-800 mb-3">${r.question.question}</p>
                    <div class="space-y-2 text-sm">`;
                r.question.answers.forEach(ans => {
                    let classes = 'review-answer flex items-center p-3 rounded-md border border-slate-200';
                    let icon = '';
                    if (isCorrectSection && ans.id === r.correctAnswerId) {
                        classes += ' is-correct-answer';
                        icon = `<i class="fas fa-check-circle text-green-500 mr-3"></i>`;
                    } else if (!isCorrectSection && ans.id === r.selectedAnswerId) {
                        classes += ' is-selected-incorrect';
                        icon = `<i class="fas fa-times-circle text-red-500 mr-3"></i>`;
                    }
                    html += `<div class="${classes}">${icon}<span>${ans.text}</span></div>`;
                });
                html += `</div></div>`;
            });
            return html + '</div></div>';
        };
        elements.reviewContainer.innerHTML = render(correct, 'Các câu trả lời đúng', true) + render(incorrect, 'Các câu cần xem lại', false);
        showScreen('reviewScreen');
    }

    function showCertificate() {
        elements.certName.innerText = userInfo.name;
        elements.certDepartment.innerText = `Phòng ban: ${userInfo.department}`;
        elements.certQuizName.innerText = document.title;
        elements.certScore.innerText = `${score}/${questionsForGame.length}`;
        elements.certDate.innerText = new Date().toLocaleDateString('vi-VN');
        showScreen('certificateScreen');
        if (elements.certificateWrapper.requestFullscreen) elements.certificateWrapper.requestFullscreen();
        else if (elements.certificateWrapper.webkitRequestFullscreen) elements.certificateWrapper.webkitRequestFullscreen();
    }

    function closeCertificate() {
        if (document.fullscreenElement || document.webkitFullscreenElement) {
            if (document.exitFullscreen) document.exitFullscreen();
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        }
        showScreen('resultArea');
    }
    
    function resetGame() {
        currentQuestionIndex = 0; score = 0;
        gameResults = []; questionsForGame = []; selectedMode = {}; userInfo = {};
        if (document.querySelectorAll('.mode-btn').length > 0) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('btn-selected-green'));
        }
        if(elements.scoreDisplay) elements.scoreDisplay.innerText = `Điểm: 0`;
        if(elements.progressBar) elements.progressBar.style.width = '0%';
        showScreen('startScreen');
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }</script></body></html>
