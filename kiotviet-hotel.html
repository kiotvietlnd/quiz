<!DOCTYPE html><html lang="vi" class="scroll-smooth"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Game KiotViet Hotel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; touch-action: manipulation; }
        .soft-glow-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -10; background: linear-gradient(to bottom right, #f8fafc, #e0f2fe); overflow: hidden; }
        .soft-glow-background .shape { position: absolute; filter: blur(140px); opacity: 0.25; }
        .soft-glow-background .shape1 { height: 350px; width: 350px; background: #166def; border-radius: 50%; top: -50px; left: -100px; animation: moveInCircle 22s ease-in-out infinite; }
        @keyframes moveInCircle { 0% { transform: rotate(0deg); } 50% { transform: rotate(180deg); } 100% { transform: rotate(360deg); } }
        .soft-glow-background .shape2 { height: 450px; width: 450px; background: #16a34a; border-radius: 50%; bottom: -100px; right: -100px; animation: moveVertical 28s ease-in-out infinite; }
        @keyframes moveVertical { 0% { transform: translateY(-50%); } 50% { transform: translateY(50%); } 100% { transform: translateY(-50%); } }
        .kv-blue { color: #166def; } .bg-kv-blue { background-color: #166def; }
        .main-card { background-color: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(203, 213, 225, 0.5); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }
        .fade-in { animation: fadeIn 0.5s ease-in-out; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .mode-btn { transition: all 0.2s ease; } .mode-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        .btn-selected-green { background-color: #16a34a !important; border-color: #15803d !important; color: white !important; }
        .correct { background-color: #10B981 !important; color: white !important; border-color: #059669 !important; }
        .incorrect { background-color: #EF4444 !important; color: white !important; border-color: #DC2626 !important; }
        #certificate-wrapper { width: 100%; max-width: 1100px; aspect-ratio: 16 / 9; display: flex; flex-direction: column; }
        #certificate-content { flex-grow: 1; border: 10px solid #166def; padding: clamp(1rem, 4vw, 2rem); background: linear-gradient(135deg, #ffffff 0%, #f7faff 100%); display: flex; flex-direction: column; justify-content: center; }
        .review-answer.is-correct-answer { border-left: 4px solid #10B981; background-color: #f0fdf4; }
        .review-answer.is-selected-incorrect { border-left: 4px solid #EF4444; background-color: #fef2f2; }
        .btn { font-weight: bold; padding: 0.75rem 2rem; border-radius: 0.5rem; text-align: center; transition: all 0.2s; cursor: pointer; }
        .btn-blue { background-color: #166def; color: white; } .btn-blue:hover { background-color: #0a58ca; }
        .btn-green { background-color: #16a34a; color: white; } .btn-green:hover { background-color: #15803d; }
        .btn-slate { background-color: #475569; color: white; } .btn-slate:hover { background-color: #334155; }
    </style></head><body class="text-slate-700 antialiased flex items-center justify-center min-h-screen p-4">
    <div class="soft-glow-background"><div class="shape shape1"></div><div class="shape shape2"></div></div>
    <main class="w-full max-w-2xl">
        <div id="start-screen" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 fade-in"></div>
        <div id="quiz-container" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden fade-in"></div>
        <div id="result-area" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden text-center fade-in"></div>
        <div id="review-screen" class="main-card rounded-2xl p-6 sm:p-8 lg:p-10 hidden fade-in w-full max-w-3xl"></div>
    </main>
    <div id="certificate-screen" class="hidden fixed inset-0 bg-slate-900/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 fade-in"></div><script>
    // --- Data Injection Placeholders (SIMPLIFIED) ---
    const quizDataForClient = [{"id":"q1","topic":"Tối ưu vận hành","question":"Trong quá trình tạo đặt phòng cho khách lưu trú, lễ tân có thể thực hiện việc thu tiền cọc ngay lập tức hay không?","answers":[{"id":"q1_a1","text":"Có thể thu tiền cọc khi đặt phòng"},{"id":"q1_a2","text":"Chỉ hỗ trợ thanh toán tiền phòng khi trả phòng, không hỗ trợ thu tiền đặt cọc"},{"id":"q1_a3","text":"Chỉ hỗ trợ thu tiền cọc khi khách đã nhận phòng"}]},{"id":"q2","topic":"Tối ưu vận hành","question":"Trên Màn hình lễ tân, khi cần tra cứu thông tin đặt phòng, lễ tân có thể áp dụng những bộ lọc nào để tìm kiếm chính xác hơn?","answers":[{"id":"q2_a1","text":"Hình thức lưu trú, Trạng thái phòng, Hạng phòng, Khu vực"},{"id":"q2_a2","text":"Tình trạng phòng, Kênh bán"},{"id":"q2_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q3","topic":"Tối ưu vận hành","question":"Trên Sơ đồ phòng, danh sách các phòng \"Sắp nhận\" được xác định dựa trên khoảng thời gian nhận phòng nào?","answers":[{"id":"q3_a1","text":"Là những phòng có giờ dự kiễn nhận phòng trong X giờ tới, do khách sạn thiết lập trong Tùy chọn hiển thị"},{"id":"q3_a2","text":"Là những phòng có lịch nhận phòng trong ngày hôm nay"},{"id":"q3_a3","text":"Là những phòng có giờ dự kiễn nhận phòng trong 30 phút sắp tới"}]},{"id":"q4","topic":"Tối ưu vận hành","question":"Khi xem lịch đặt phòng dưới dạng Lưới, khung thời gian nào được hỗ trợ để hiển thị lịch?","answers":[{"id":"q4_a1","text":"Tháng"},{"id":"q4_a2","text":"Quý"},{"id":"q4_a3","text":"Năm"}]},{"id":"q5","topic":"Tối ưu vận hành","question":"Trên Màn hình lễ tân, giao diện nào cho phép người dùng xuất file danh sách đặt phòng?","answers":[{"id":"q5_a1","text":"Dạng Danh sách"},{"id":"q5_a2","text":"Dạng lưới"},{"id":"q5_a3","text":"Dạng sơ đồ"}]},{"id":"q6","topic":"Tối ưu vận hành","question":"Nếu một đặt phòng bao gồm 3 phòng nhưng chỉ có 2 phòng đến sớm, lễ tân có thể tiến hành nhận phòng riêng lẻ cho 2 phòng này không?","answers":[{"id":"q6_a1","text":"Có thể làm thủ tục nhận phòng trước cho 2 phòng"},{"id":"q6_a2","text":"Khi nhận phòng luôn luôn phải nhận từng phòng 1"},{"id":"q6_a3","text":"Chỉ có thể làm thủ tục nhận phòng cho toàn bộ 3 phòng trong đặt phòng"}]},{"id":"q7","topic":"Tối ưu vận hành","question":"Nếu lễ tân vô tình nhấn Nhận phòng sai, có cách nào để quay lại trạng thái ban đầu không?","answers":[{"id":"q7_a1","text":"Sử dụng chức năng Hoàn tác"},{"id":"q7_a2","text":"Sử dụng chức năng Trở lại trạng thái trước"},{"id":"q7_a3","text":"Không hoàn tác được, cần hủy đặt phòng và tạo đặt phòng khác"}]},{"id":"q8","topic":"Tối ưu vận hành","question":"Khi lễ tân cần nhập số CCCD của khách hàng vào phần mềm, có những cách nào để thực hiện nhanh chóng?","answers":[{"id":"q8_a1","text":"Sử dụng webcam máy tính"},{"id":"q8_a2","text":"Sử dụng máy quét mã vạch"},{"id":"q8_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q9","topic":"Tối ưu vận hành","question":"Sau khi khách đã lưu trú 1 ngày, làm thế nào để nâng hạng phòng cho khách mà không thay đổi giá phòng ban đầu?","answers":[{"id":"q9_a1","text":"Chọn Đổi phòng, tùy chọn > Giữ nguyên giá phòng"},{"id":"q9_a2","text":"Chọn Đổi phòng, tùy chọn > Áp dụng giá hạng phòng mới"},{"id":"q9_a3","text":"Tính năng chưa được hỗ trợ"}]},{"id":"q10","topic":"Tối ưu vận hành","question":"Để thêm một phòng lẻ vào danh sách đặt phòng của một đoàn, lễ tân cần thực hiện thao tác nào?","answers":[{"id":"q10_a1","text":"Chưa hỗ trợ tính năng này, cần xóa đặt phòng khách lẻ, nhập lại thông tin vào đặt phòng khách đoàn"},{"id":"q10_a2","text":"Sử dụng tính năng Ghép đoàn trên Màn hình lễ tân"},{"id":"q10_a3","text":"Sử dụng tính năng Cập nhật đặt phòng trên Màn hình quản lý"}]},{"id":"q11","topic":"Tối ưu vận hành","question":"Để bán dịch vụ ăn sáng cho khách hàng không lưu trú tại khách sạn, lễ tân cần thực hiện thao tác nào?","answers":[{"id":"q11_a1","text":"Tạo hóa đơn bán lẻ"},{"id":"q11_a2","text":"Tạo 1 đặt phòng, nhận phòng, sau đó nhập thông tin dịch vụ ăn sáng, trả phòng"},{"id":"q11_a3","text":"Chưa hỗ trợ tính năng này"}]},{"id":"q12","topic":"Tối ưu vận hành","question":"Khi cần yêu cầu bộ phận buồng kiểm tra phòng qua điện thoại, lễ tân cần thực hiện thao tác gì?","answers":[{"id":"q12_a1","text":"Bấm Trả phòng và lựa chọn Gửi yêu cầu kiểm phòng"},{"id":"q12_a2","text":"Bấm Trả phòng và lựa chọn Kiểm đồ"},{"id":"q12_a3","text":"Bấm Trả phòng và lựa chọn Xác nhận kiểm đồ"}]},{"id":"q13","topic":"Tối ưu vận hành","question":"Để cấu hình danh mục minibar cho từng loại phòng, người dùng cần thực hiện thao tác nào?","answers":[{"id":"q13_a1","text":"Thiết lập minibar trong mục Hạng phòng"},{"id":"q13_a2","text":"Thiết lập minibar trong mục Hàng hóa"},{"id":"q13_a3","text":"Thiết lập minibar trên Màn hình lễ tân"}]},{"id":"q14","topic":"Tối ưu vận hành","question":"Sau khi nhận được xác nhận từ bộ phận buồng về việc khách sử dụng minibar, lễ tân cần thực hiện thao tác nào để tính chi phí?","answers":[{"id":"q14_a1","text":"Lễ tân lựa chọn Xác nhận kiểm phòng"},{"id":"q14_a2","text":"Lễ tân thêm thủ công từng món minibar từ Danh mục hàng hóa"},{"id":"q14_a3","text":"Lễ tân chọn Yêu cầu kiểm phòng"}]},{"id":"q15","topic":"Tối ưu vận hành","question":"Nếu khách hàng muốn thanh toán riêng tiền phòng và tiền dịch vụ, lễ tân có thể sử dụng tính năng nào để hỗ trợ?","answers":[{"id":"q15_a1","text":"Có thể sử dụng chức năng Tách ghép đơn"},{"id":"q15_a2","text":"Có thể sử dụng chức năng Tạo hóa đơn một phần"},{"id":"q15_a3","text":"Không thể"}]},{"id":"q16","topic":"Tối ưu vận hành","question":"Để hiển thị mã chuyển khoản VietQR khi thanh toán, lễ tân cần thực hiện thao tác gì?","answers":[{"id":"q16_a1","text":"Tạo thông tin STK Ngân hàng trên Sổ quỹ hoặc khi thanh toán trên Màn hình lễ tân"},{"id":"q16_a2","text":"Thiết lập trong thiết lập cửa hàng"},{"id":"q16_a3","text":"Liên hệ ngân hàng tạo mã QR liên kết với phần mềm KiotViet"}]},{"id":"q17","topic":"Tối ưu vận hành","question":"KiotViet hỗ trợ tích hợp thông báo giao dịch thành công với ví điện tử nào hiện nay?","answers":[{"id":"q17_a1","text":"MOMO Doanh nghiệp"},{"id":"q17_a2","text":"Shopee Pay"},{"id":"q17_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q18","topic":"Tối ưu vận hành","question":"Dịch vụ thông báo thanh toán QR hiện hỗ trợ ngân hàng nào?","answers":[{"id":"q18_a1","text":"BIDV"},{"id":"q18_a2","text":"VP Bank"},{"id":"q18_a3","text":"K Bank"}]},{"id":"q19","topic":"Tối ưu vận hành","question":"Thiết bị QR - F92 có khả năng hỗ trợ những tính năng nào khi tích hợp với Dịch vụ thông báo thanh toán QR?","answers":[{"id":"q19_a1","text":"Đọc \"Thanh toán thành công\""},{"id":"q19_a2","text":"Đọc số tiền nhận được thành công"},{"id":"q19_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q20","topic":"Tối ưu vận hành","question":"KiotViet Hotel có thể kết nối với những phần mềm Hóa đơn điện tử nào hiện nay?","answers":[{"id":"q20_a1","text":"VNPT, Misa, Viettel"},{"id":"q20_a2","text":"\" FPT, Misa, Viettel\""},{"id":"q20_a3","text":"\" FPT, Misa, VNPT\""}]},{"id":"q21","topic":"Tối ưu vận hành","question":"Để sử dụng tính năng quản lý thẻ từ, người dùng cần kích hoạt những ứng dụng nào?","answers":[{"id":"q21_a1","text":"Ứng dụng quản lý thẻ từ của nhà cung cấp khóa từ"},{"id":"q21_a2","text":"Ứng dụng KiotViet kết nối khóa từ"},{"id":"q21_a3","text":"Cần bật đồng thời cả 2 ứng dụng: Ứng dụng quản lý thẻ từ của nhà cung cấp khóa từ và Ứng dụng KiotViet kết nối khóa từ"}]},{"id":"q22","topic":"Tối ưu vận hành","question":"Nếu bộ phận buồng thông báo đã dọn sạch toàn bộ phòng Tầng 2, làm thế nào để lễ tân cập nhật trạng thái này trên hệ thống?","answers":[{"id":"q22_a1","text":"Trên màn hình lễ tân, lễ tân vào Tùy chọn Buồng phòng, lựa chọn các phòng Tầng 2 và bấm Làm sạch"},{"id":"q22_a2","text":"Trên app điện thoại, bộ phận buồng chọn các phòng Tầng 2 và bấm Làm sạch hàng loạt"},{"id":"q22_a3","text":"Chưa hỗ trợ quản lý trạng thái phòng Sạch/Chưa dọn"}]},{"id":"q23","topic":"Tối ưu vận hành","question":"Bộ phận buồng có thể sử dụng những phương pháp nào để cập nhật trạng thái phòng từ \"Chưa dọn\" sang \"Sạch\"?","answers":[{"id":"q23_a1","text":"Sử dụng app KiotViet Hotel cập nhật ngay trên điện thoại"},{"id":"q23_a2","text":"Gọi bộ đàm, thông báo cho lễ tân đổi trạng thái phòng trên máy tính"},{"id":"q23_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q24","topic":"Tối ưu vận hành","question":"Khi bắt đầu ca làm việc sử dụng tính năng kết ca, nhân viên cần nhập thông tin nào vào hệ thống?","answers":[{"id":"q24_a1","text":"Tiền mặt đầu ca"},{"id":"q24_a2","text":"Tiền ví điện tử đầu ca"},{"id":"q24_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q25","topic":"Tối ưu quản lý","question":"Để áp dụng phụ thu 30.000/h khi khách trả phòng muộn sau 12:00, cần cấu hình thông tin này ở đâu?","answers":[{"id":"q25_a1","text":"Nhập mức phụ thu 30.000/h ở trong phần Thiết lập giá"},{"id":"q25_a2","text":"Nhập mức phụ thu 30.000/h ở trong mục từng Hạng phòng"},{"id":"q25_a3","text":"Nhập mức phụ thu 30.000/h ở trong Thiết lập cửa hàng"}]},{"id":"q26","topic":"Tối ưu quản lý","question":"Hệ thống có hỗ trợ tạo nhiều bảng giá phòng để áp dụng cho các nhóm khách hàng khác nhau không?","answers":[{"id":"q26_a1","text":"Chỉ tạo được 1 bảng giá"},{"id":"q26_a2","text":"Chỉ tạo được tối đa 2 bảng giá"},{"id":"q26_a3","text":"Có thể tạo được nhiều hơn 2 bảng giá"}]},{"id":"q27","topic":"Tối ưu quản lý","question":"Để thiết lập giá nghỉ giờ theo mô hình bậc thang (2 giờ đầu 200.000, mỗi giờ tiếp theo 20.000), cần thực hiện cấu hình nào?","answers":[{"id":"q27_a1","text":"Ghi nhận Từ giờ thứ 1 giá Cả block 200.000 và Từ giờ thứ 3 giá mỗi giờ 20.000"},{"id":"q27_a2","text":"Ghi nhận Từ giờ thứ 1 giá Cả block 100.000 và Từ giờ thứ 2 giá mỗi giờ 20.000"},{"id":"q27_a3","text":"Ghi nhận Từ giờ thứ 1 giá Cả block 200.000 và Từ giờ thứ 2 giá mỗi giờ 20.000"}]},{"id":"q28","topic":"Tối ưu quản lý","question":"Để áp dụng mức giá nghỉ theo ngày cao hơn 50.000 cho ngày cuối tuần, cần sử dụng tính năng nào?","answers":[{"id":"q28_a1","text":"Sử dụng Bảng giá chung"},{"id":"q28_a2","text":"Sử dụng Bảng giá tùy chỉnh trong Thiết lập giá"},{"id":"q28_a3","text":"Sử dụng tính năng thêm dòng"}]},{"id":"q29","topic":"Tối ưu quản lý","question":"Sau khi kích hoạt tính năng thuê tháng, làm thế nào để cập nhật giá thuê tháng cho các phòng hiện có?","answers":[{"id":"q29_a1","text":"Phòng > Thiết lập giá"},{"id":"q29_a2","text":"Phòng > Hạng phòng & Phòng > Hạng phòng"},{"id":"q29_a3","text":"Hàng hóa > Danh mục"}]},{"id":"q30","topic":"Tối ưu quản lý","question":"Nếu khách hàng thuê phòng dài hạn (3 tháng), có thể thanh toán tiền phòng theo từng tháng mà không cần trả phòng không?","answers":[{"id":"q30_a1","text":"Phòng thuê tháng chưa trả phòng có thể tạo hóa đơn một phần"},{"id":"q30_a2","text":"Phòng thuê tháng phải trả phòng mới có thể tạo hóa đơn một phầPn"},{"id":"q30_a3","text":"Chưa hỗ trợ thanh toán một phần hóa đơn tiền phòng"}]},{"id":"q31","topic":"Tối ưu quản lý","question":"Để thêm Dịch vụ ăn sáng vào hệ thống KiotViet Hotel, cần thực hiện thao tác nào?","answers":[{"id":"q31_a1","text":"Tạo Hàng hóa thường"},{"id":"q31_a2","text":"Tạo Hàng hóa Dịch vụ"},{"id":"q31_a3","text":"Tạo hàng hóa Gói Dịch vụ"}]},{"id":"q32","topic":"Tối ưu quản lý","question":"Khi khách sử dụng lon Pepsi trong minibar phòng VIP, hệ thống sẽ dựa vào đâu để tính tiền?","answers":[{"id":"q32_a1","text":"Giá bán nào được nhập gần nhất"},{"id":"q32_a2","text":"Ưu tiên giá bán trong Danh mục Hàng hóa"},{"id":"q32_a3","text":"Ưu tiên giá bán thiết lập trong Minibar"}]},{"id":"q33","topic":"Tối ưu quản lý","question":"Để cấu hình danh mục Minibar cho một hạng phòng cụ thể, người dùng cần thực hiện thao tác nào?","answers":[{"id":"q33_a1","text":"Phòng > Hạng phòng & Phòng > Hạng phòng"},{"id":"q33_a2","text":"Màn hình lễ tân"},{"id":"q33_a3","text":"Phòng > Hạng phòng & Phòng > Thiết lập giá"}]},{"id":"q34","topic":"Tối ưu quản lý","question":"Khi thêm mới khách hàng vào hệ thống KiotViet Hotel, thông tin nào là bắt buộc?","answers":[{"id":"q34_a1","text":"SĐT"},{"id":"q34_a2","text":"Căn cước công dân"},{"id":"q34_a3","text":"Cả 2 phương án còn lại đều sai"}]},{"id":"q35","topic":"Tối ưu quản lý","question":"Khi thêm mới Nhà cung cấp vào hệ thống, thông tin nào là bắt buộc phải cung cấp?","answers":[{"id":"q35_a1","text":"Điện thoại / Email"},{"id":"q35_a2","text":"Điện thoại / CCCD"},{"id":"q35_a3","text":"Điện thoại / MST"}]},{"id":"q36","topic":"Tối ưu quản lý","question":"Khi sử dụng Zalo Mini App “KiotViet Nhân viên”, nhân viên có cần được phê duyệt quyền truy cập hay không?","answers":[{"id":"q36_a1","text":"\"Với lần đầu truy cập trực tiếp vào app từ Zalo, nhân viên cần được phê duyệt thiết bị mới bởi chủ gian hàng \""},{"id":"q36_a2","text":"Với mỗi lần chấm công, nhân viên cần được phê duyệt"},{"id":"q36_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q37","topic":"Tối ưu quản lý","question":"Khi lập phiếu thu hoặc phiếu chi, hệ thống có cho phép tải file đính kèm không?","answers":[{"id":"q37_a1","text":"Chỉ hỗ trợ tải file đính kèm khi Lập phiếu thu"},{"id":"q37_a2","text":"Chỉ hỗ trợ tải file đính kèm khi Lập phiếu Chi"},{"id":"q37_a3","text":"Hỗ trợ tải file đính kèm khi Lập phiếu thu và phiếu chi"}]},{"id":"q38","topic":"Tối ưu quản lý","question":"Báo cáo lễ tân trên Màn hình lễ tân hiển thị những thông tin nào liên quan đến hoạt động kinh doanh?","answers":[{"id":"q38_a1","text":"Công suất sử dụng phòng"},{"id":"q38_a2","text":"Công nợ"},{"id":"q38_a3","text":"Doanh thu bán phòng"}]},{"id":"q39","topic":"Tối ưu quản lý","question":"Khi tài khoản admin quên mật khẩu, có những phương thức nào để khôi phục mật khẩu?","answers":[{"id":"q39_a1","text":"Email"},{"id":"q39_a2","text":"SMS"},{"id":"q39_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q40","topic":"Thúc đẩy doanh thu","question":"Lễ tân có thể nhận biết khách đặt phòng online qua những dấu hiệu nào trên hệ thống?","answers":[{"id":"q40_a1","text":"Nhận biết qua dấu chấm đỏ trên màn hình lễ tân"},{"id":"q40_a2","text":"Nhận biết qua thông báo trên mobile app KiotViet Hotel"},{"id":"q40_a3","text":"Nhận biết qua dấu chấm đỏ trên màn hình lễ tân và thông báo trên mobile app KiotViet Hotel"}]},{"id":"q41","topic":"Thúc đẩy doanh thu","question":"Khi sử dụng KiotViet Web, chi phí cho đuôi tên miền homevilla.net và homemotel.net.vn là bao nhiêu?","answers":[{"id":"q41_a1","text":"Miễn phí"},{"id":"q41_a2","text":"100.000/tháng"},{"id":"q41_a3","text":"100.000/năm"}]},{"id":"q42","topic":"Thúc đẩy doanh thu","question":"Để liên kết và gửi email từ KiotViet, tài khoản Google của khách sạn cần kích hoạt tính năng nào?","answers":[{"id":"q42_a1","text":"Xác thực 2 lớp"},{"id":"q42_a2","text":"Google Workspace"},{"id":"q42_a3","text":"YouTube Premium"}]},{"id":"q43","topic":"Thúc đẩy doanh thu","question":"Hệ thống KiotViet hỗ trợ gửi email tự động cho khách hàng trong những trường hợp nào?","answers":[{"id":"q43_a1","text":"Xác nhận đặt phòng"},{"id":"q43_a2","text":"\" Hủy đặt phòng\""},{"id":"q43_a3","text":"\" Xác nhận đặt phòng, hủy đặt phòng, điều chỉnh đặt phòng\""}]},{"id":"q44","topic":"Thúc đẩy doanh thu","question":"Khách sạn có thể sử dụng tính năng ZNS trên KiotViet để gửi tin nhắn với mục đích gì?","answers":[{"id":"q44_a1","text":"Xác nhận đặt phòng, Hủy đặt phòng, Cảm ơn, và Chờ xác nhận đặt phòng."},{"id":"q44_a2","text":"Chúc mừng sinh nhật"},{"id":"q44_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q45","topic":"Thúc đẩy doanh thu","question":"Tính năng Channel Managers kết nối OTA (Booking, Agoda...) mang lại lợi ích gì cho khách sạn?","answers":[{"id":"q45_a1","text":"Quản lý giá phòng trên OTA tập trung"},{"id":"q45_a2","text":"Quản lý số phòng trống mở bán trên OTA tập trung"},{"id":"q45_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q46","topic":"Thúc đẩy doanh thu","question":"Khi đồng bộ thông tin đặt phòng từ Airbnb về KiotViet, hệ thống cung cấp những dữ liệu nào?","answers":[{"id":"q46_a1","text":"Tên khách"},{"id":"q46_a2","text":"Giá phòng"},{"id":"q46_a3","text":"Ngày check-in, ngày check-out"}]},{"id":"q47","topic":"Thúc đẩy doanh thu","question":"Khi đặt phòng mới từ Airbnb được đồng bộ thành công vào KiotViet, người dùng có thể nhận thông báo ở đâu?","answers":[{"id":"q47_a1","text":"Màn hình lễ tân trên Web"},{"id":"q47_a2","text":"Thông báo notification trên app"},{"id":"q47_a3","text":"Cả 2 phương án còn lại đều đúng"}]},{"id":"q48","topic":"Thúc đẩy doanh thu","question":"Tính năng Facebook POS hỗ trợ khách sạn trong việc làm gì?","answers":[{"id":"q48_a1","text":"Hỗ trợ livestream bán phòng online"},{"id":"q48_a2","text":"Quản lý tin nhắn, bình luận"},{"id":"q48_a3","text":"Chạy quảng cáo cho fanpage khách sạn"}]},{"id":"q49","topic":"Thúc đẩy doanh thu","question":"Để tạo mã voucher giảm giá 300.000 cho khách hàng, cần thực hiện thao tác nào?","answers":[{"id":"q49_a1","text":"Khi thanh toán nhập 300.000 vào phần Giảm giá"},{"id":"q49_a2","text":"Sử dụng tính năng Tích điểm"},{"id":"q49_a3","text":"Vào Thiết lập cửa hàng, bật tính năng Voucher, sau đó vào Thiết lập > Quản lý Voucher để tạo đợt phát hành"}]},{"id":"q50","topic":"Thúc đẩy doanh thu","question":"Khách sạn có thể thiết lập điểm tích lũy tùy chỉnh cho từng khách hàng không? Nếu có, cần thực hiện thao tác nào?","answers":[{"id":"q50_a1","text":"Khách hàng phải thanh toán tiền phòng mới có thể có điểm"},{"id":"q50_a2","text":"Có thể sử dụng chức năng Điều chỉnh để nhập số điểm theo mong muốn của khách sạn"},{"id":"q50_a3","text":"Chưa hỗ trợ tính năng Tích điểm trên KiotViet Hotel"}]}];
    const answerKey = {"q1":"q1_a1","q2":"q2_a3","q3":"q3_a1","q4":"q4_a1","q5":"q5_a1","q6":"q6_a1","q7":"q7_a2","q8":"q8_a3","q9":"q9_a1","q10":"q10_a2","q11":"q11_a1","q12":"q12_a1","q13":"q13_a1","q14":"q14_a1","q15":"q15_a2","q16":"q16_a1","q17":"q17_a1","q18":"q18_a1","q19":"q19_a3","q20":"q20_a1","q21":"q21_a3","q22":"q22_a1","q23":"q23_a3","q24":"q24_a1","q25":"q25_a2","q26":"q26_a3","q27":"q27_a1","q28":"q28_a2","q29":"q29_a2","q30":"q30_a1","q31":"q31_a2","q32":"q32_a3","q33":"q33_a1","q34":"q34_a3","q35":"q35_a1","q36":"q36_a1","q37":"q37_a3","q38":"q38_a1","q39":"q39_a3","q40":"q40_a3","q41":"q41_a1","q42":"q42_a1","q43":"q43_a3","q44":"q44_a1","q45":"q45_a3","q46":"q46_a3","q47":"q47_a3","q48":"q48_a2","q49":"q49_a3","q50":"q50_a2"}; // Direct object, no encoding
    const feedbackMessages = { incorrect: `Rất tiếc, bạn đã sai. Bạn hãy tham khảo thêm tài liệu tại <a href='https://sites.google.com/view/thuvienkiotviet' target='_blank' class='underline text-blue-600 hover:text-blue-800'>Thư viện KiotViet</a> nhé!`, fail: `Cần cố gắng hơn! Bạn hãy tham khảo thêm tài liệu tại <a href='https://sites.google.com/view/thuvienkiotviet' target='_blank' class='underline text-blue-600 hover:text-blue-800'>Thư viện KiotViet</a> nhé!` };
    
    // --- State & Global Variables ---
    let currentQuestionIndex, score, questionsForGame, gameResults, selectedMode, userInfo;
    
    const elements = {};

    function setupHTML() {
        elements.startScreen = document.getElementById('start-screen');
        elements.quizContainer = document.getElementById('quiz-container');
        elements.resultArea = document.getElementById('result-area');
        elements.reviewScreen = document.getElementById('review-screen');
        elements.certificateScreen = document.getElementById('certificate-screen');

        elements.startScreen.innerHTML = `
             <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-10 mx-auto mb-6">
             <h1 class="text-2xl sm:text-3xl font-bold text-slate-800 text-center mb-2">${document.title}</h1>
             <p class="text-slate-600 text-center mb-6">Vui lòng nhập thông tin và chọn chế độ chơi</p>
             <div class="space-y-4 mb-6">
                <div><label for="name-input" class="block text-sm font-medium text-slate-700 mb-1">Họ và tên</label><input type="text" id="name-input" class="w-full p-3 bg-white/80 border border-slate-300 rounded-lg focus:ring-2 focus:ring-kv-blue" placeholder="Nguyễn Văn A"></div>
                <div><label for="department-input" class="block text-sm font-medium text-slate-700 mb-1">Phòng ban</label><input type="text" id="department-input" class="w-full p-3 bg-white/80 border border-slate-300 rounded-lg" placeholder="TSHNI99"></div>
             </div>
             <div id="mode-selection-area" class="space-y-6"></div>
             <p id="error-message" class="text-red-500 text-center mt-4 h-5"></p>
             <button id="start-btn" class="w-full mt-4 btn btn-blue text-lg">Bắt đầu</button>`;
        
        elements.quizContainer.innerHTML = `
            <div class="flex justify-between items-center mb-4">
                <div class="text-sm font-semibold text-slate-600"><span id="question-count"></span></div>
                <div id="score-display" class="text-lg font-bold text-kv-blue">Điểm: 0</div>
            </div>
            <div class="w-full bg-slate-200 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-kv-blue h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <p id="question-text" class="text-xl font-semibold text-slate-800 mb-6 min-h-[84px]"></p>
            <div id="answers-container" class="space-y-3"></div>
            <div id="feedback-area" class="mt-6 text-center"></div>
            <button id="next-btn" class="hidden w-full mt-6 btn btn-green text-lg">Câu tiếp theo</button>`;

        elements.resultArea.innerHTML = `
            <h2 id="result-title" class="text-3xl font-bold text-slate-800 mb-4">Hoàn thành!</h2>
            <p id="score-text" class="text-xl text-slate-600 mb-6"></p>
            <div id="fail-message" class="hidden text-lg text-red-600 font-semibold mb-6">${feedbackMessages.fail}</div>
            <div class="flex flex-col sm:flex-row justify-center gap-4">
                 <button id="review-btn" class="btn btn-slate">Xem lại đáp án</button>
                 <button id="certificate-btn" class="hidden btn btn-green">Xem giấy khen</button>
                 <button id="restart-btn" class="btn btn-blue">Chơi lại</button>
            </div>`;
        
        elements.reviewScreen.innerHTML = `
            <h2 class="text-2xl font-bold text-slate-800 text-center mb-6">Xem Lại Kết Quả</h2>
            <div id="review-container" class="space-y-6 max-h-[60vh] overflow-y-auto pr-2"></div>
            <div class="mt-8 flex flex-col sm:flex-row justify-center gap-4">
                <button id="certificate-btn-from-review" class="hidden btn btn-green">Xem giấy khen</button>
                <button id="restart-from-review-btn" class="btn btn-blue">Chơi lại</button>
            </div>`;

        elements.certificateScreen.innerHTML = `
            <div id="certificate-wrapper">
                <div id="certificate-content">
                    <div class="text-center">
                        <img src="https://logo.kiotviet.vn/KiotViet-Logo-Horizontal.svg" alt="KiotViet Logo" class="h-8 sm:h-10 mx-auto mb-4">
                        <h1 class="text-2xl sm:text-4xl font-bold text-kv-blue" style="font-family: 'Times New Roman', serif;">GIẤY CHỨNG NHẬN</h1>
                        <p class="text-base sm:text-lg mt-4">Trân trọng trao cho</p>
                        <p id="cert-name" class="text-xl sm:text-3xl font-bold text-slate-800 my-4 border-b-2 border-slate-300 pb-2"></p>
                        <p id="cert-department" class="text-base sm:text-lg font-medium text-slate-600 -mt-2 mb-4"></p>
                        <p class="text-base sm:text-lg">Đã xuất sắc hoàn thành bài kiểm tra</p>
                        <p id="cert-quiz-name" class="text-lg sm:text-xl font-semibold my-2 text-slate-700"></p>
                        <p class="text-base sm:text-lg">Với số điểm</p>
                        <p id="cert-score" class="text-3xl sm:text-4xl font-bold text-green-600 my-4"></p>
                        <p class="text-xs sm:text-sm text-slate-500">Ngày hoàn thành: <span id="cert-date"></span></p>
                    </div>
                </div>
                <div class="flex flex-col sm:flex-row justify-center gap-4 mt-4">
                    <button id="review-btn-from-cert" class="btn btn-slate">Xem lại đáp án</button>
                    <button id="close-cert-btn" class="btn btn-blue">Đóng</button>
                </div>
            </div>`;
    }

    function cacheElements() {
        const ids = [
            'name-input', 'department-input', 'mode-selection-area', 'error-message', 'start-btn',
            'question-count', 'score-display', 'progress-bar', 'question-text', 'answers-container',
            'feedback-area', 'next-btn', 'result-title', 'score-text', 'fail-message', 'review-btn',
            'certificate-btn', 'restart-btn', 'review-container', 'certificate-btn-from-review',
            'restart-from-review-btn', 'certificate-wrapper', 'cert-name', 'cert-department',
            'cert-quiz-name', 'cert-score', 'cert-date', 'review-btn-from-cert', 'close-cert-btn'
        ];
        ids.forEach(id => {
            elements[id.replace(/-(\w)/g, (m, p1) => p1.toUpperCase())] = document.getElementById(id);
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        setupHTML();
        cacheElements();
        if (!answerKey || !quizDataForClient) {
            document.body.innerHTML = `<p style='font-family: sans-serif; text-align: center; margin-top: 50px; font-size: 1.2rem; color: #b91c1c;'>Lỗi nghiêm trọng: Dữ liệu trò chơi bị hỏng.</p>`;
            return;
        }
        setupModeSelection();
        addEventListeners();
        resetGame();
    });
    
    function setupModeSelection() {
        const topics = [...new Set(quizDataForClient.map(q => q.topic))].filter(Boolean);
        let html = `
            <div id="random-mode-group">
                <p class="font-semibold text-slate-800 text-center mb-3">Chơi ngẫu nhiên</p>
                <div class="flex flex-wrap justify-center gap-3">
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="5">5 câu</button>
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="30">30 câu</button>
                    <button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="random" data-count="all">Toàn bộ</button>
                </div>
            </div>`;
        if (topics.length > 0) {
            html += `
                <div id="topic-mode-group" class="mt-6">
                    <p class="font-semibold text-slate-800 text-center mb-3">Chơi theo chủ đề</p>
                    <div class="flex flex-wrap justify-center gap-3">
                        ${topics.map(topic => `<button class="mode-btn bg-white border border-slate-300 text-slate-700 font-semibold py-2 px-5 rounded-lg" data-mode="topic" data-topic="${topic}">${topic}</button>`).join('')}
                    </div>
                </div>`;
        }
        elements.modeSelectionArea.innerHTML = html;
        
        document.querySelectorAll('.mode-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('btn-selected-green'));
                e.currentTarget.classList.add('btn-selected-green');
                selectedMode = e.currentTarget.dataset;
            });
        });
    }

    function addEventListeners() {
        elements.startBtn.addEventListener('click', startGame);
        elements.nextBtn.addEventListener('click', nextQuestion);
        elements.restartBtn.addEventListener('click', resetGame);
        elements.restartFromReviewBtn.addEventListener('click', resetGame);
        elements.reviewBtn.addEventListener('click', showReview);
        elements.certificateBtn.addEventListener('click', showCertificate);
        elements.closeCertBtn.addEventListener('click', closeCertificate);
        elements.certificateBtnFromReview.addEventListener('click', showCertificate);
        elements.reviewBtnFromCert.addEventListener('click', showReview);
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement && !elements.certificateScreen.classList.contains('hidden')) {
                showScreen('resultArea');
            }
        });
    }

    function showScreen(screenKey) {
        ['startScreen', 'quizContainer', 'resultArea', 'reviewScreen', 'certificateScreen'].forEach(key => {
            elements[key].classList.add('hidden');
        });
        elements[screenKey].classList.remove('hidden');
        document.querySelector('main').style.display = (screenKey === 'certificateScreen') ? 'none' : 'block';
    }

    function startGame() {
        userInfo = { name: elements.nameInput.value.trim(), department: elements.departmentInput.value.trim() };
        if (!userInfo.name || !userInfo.department) {
            elements.errorMessage.innerText = 'Vui lòng điền đầy đủ Họ và tên và Phòng ban.'; return;
        }
        if (!selectedMode || !selectedMode.mode) {
            elements.errorMessage.innerText = 'Vui lòng chọn một chế độ chơi.'; return;
        }
        elements.errorMessage.innerText = '';
        prepareQuestions();
        if (questionsForGame.length === 0) {
            elements.errorMessage.innerText = 'Không có câu hỏi cho chủ đề này.'; return;
        }
        showScreen('quizContainer');
        showQuestion();
    }

    function prepareQuestions() {
        let source = [...quizDataForClient];
        if (selectedMode.mode === 'topic') {
            source = source.filter(q => q.topic === selectedMode.topic);
        }
        source = shuffleArray(source);
        if (selectedMode.count && selectedMode.count !== 'all') {
            questionsForGame = source.slice(0, parseInt(selectedMode.count, 10));
        } else { questionsForGame = source; }
    }

    function showQuestion() {
        elements.feedbackArea.innerHTML = '';
        elements.nextBtn.classList.add('hidden');
        const q = questionsForGame[currentQuestionIndex];
        elements.questionCount.innerText = `Câu ${currentQuestionIndex + 1}/${questionsForGame.length}`;
        elements.progressBar.style.width = `${((currentQuestionIndex + 1) / questionsForGame.length) * 100}%`;
        elements.questionText.innerText = q.question;
        elements.answersContainer.innerHTML = '';
        shuffleArray([...q.answers]).forEach(ans => {
            const btn = document.createElement('button');
            btn.innerHTML = `<span>${ans.text}</span>`;
            btn.className = 'w-full text-left p-4 bg-white/80 border-2 border-slate-300 rounded-lg hover:bg-blue-100 hover:border-kv-blue transition-all duration-200 flex items-center';
            btn.dataset.answerId = ans.id;
            btn.dataset.questionId = q.id;
            btn.onclick = selectAnswer;
            elements.answersContainer.appendChild(btn);
        });
    }

    function selectAnswer(e) {
        const selectedBtn = e.currentTarget;
        const { questionId, answerId } = selectedBtn.dataset;
        const isCorrect = answerId === answerKey[questionId];

        gameResults.push({
            question: questionsForGame[currentQuestionIndex],
            selectedAnswerId: answerId,
            correctAnswerId: answerKey[questionId],
            isCorrect
        });

        const feedback = document.createElement('p');
        feedback.className = 'font-medium text-lg';
        if (isCorrect) {
            score++;
            elements.scoreDisplay.innerText = `Điểm: ${score}`;
            feedback.innerHTML = '🎉 Chúc mừng bạn, đáp án hoàn toàn chính xác!';
            feedback.className += ' text-green-600';
            selectedBtn.classList.add('correct');
        } else {
            feedback.innerHTML = feedbackMessages.incorrect; // Changed to innerHTML to render the link
            feedback.className += ' text-red-500';
            selectedBtn.classList.add('incorrect');
        }
        elements.feedbackArea.appendChild(feedback);
        Array.from(elements.answersContainer.children).forEach(button => button.onclick = null);
        elements.nextBtn.classList.remove('hidden');
    }

    function nextQuestion() {
        currentQuestionIndex++;
        (currentQuestionIndex < questionsForGame.length) ? showQuestion() : showScore();
    }

    function showScore() {
        const percentage = (score / questionsForGame.length) * 100;
        elements.scoreText.innerText = `Bạn đã trả lời đúng ${score}/${questionsForGame.length} câu (${percentage.toFixed(0)}%)`;
        const passed = percentage >= 80;
        elements.resultTitle.innerText = passed ? "Xuất sắc!" : "Hoàn thành!";
        elements.failMessage.classList.toggle('hidden', passed);
        elements.certificateBtn.classList.toggle('hidden', !passed);
        elements.certificateBtnFromReview.classList.toggle('hidden', !passed);
        if (passed) confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
        showScreen('resultArea');
    }

    function showReview() {
        const correct = gameResults.filter(r => r.isCorrect);
        const incorrect = gameResults.filter(r => !r.isCorrect);

        const render = (results, title, isCorrectSection) => {
            if (results.length === 0) return '';
            let html = `<div class="mb-8"><h3 class="text-xl font-bold ${isCorrectSection ? 'text-green-600' : 'text-red-600'} border-b-2 pb-2 mb-4">${title} (${results.length})</h3><div class="space-y-4">`;
            results.forEach(r => {
                html += `<div class="p-4 bg-white/50 rounded-lg shadow-sm">
                    <p class="font-semibold text-slate-800 mb-3">${r.question.question}</p>
                    <div class="space-y-2 text-sm">`;
                r.question.answers.forEach(ans => {
                    let classes = 'review-answer flex items-center p-3 rounded-md border border-slate-200';
                    let icon = '';
                    if (isCorrectSection && ans.id === r.correctAnswerId) {
                        classes += ' is-correct-answer';
                        icon = `<i class="fas fa-check-circle text-green-500 mr-3"></i>`;
                    } else if (!isCorrectSection && ans.id === r.selectedAnswerId) {
                        classes += ' is-selected-incorrect';
                        icon = `<i class="fas fa-times-circle text-red-500 mr-3"></i>`;
                    }
                    html += `<div class="${classes}">${icon}<span>${ans.text}</span></div>`;
                });
                html += `</div></div>`;
            });
            return html + '</div></div>';
        };
        elements.reviewContainer.innerHTML = render(correct, 'Các câu trả lời đúng', true) + render(incorrect, 'Các câu cần xem lại', false);
        showScreen('reviewScreen');
    }

    function showCertificate() {
        elements.certName.innerText = userInfo.name;
        elements.certDepartment.innerText = `Phòng ban: ${userInfo.department}`;
        elements.certQuizName.innerText = document.title;
        elements.certScore.innerText = `${score}/${questionsForGame.length}`;
        elements.certDate.innerText = new Date().toLocaleDateString('vi-VN');
        showScreen('certificateScreen');
        if (elements.certificateWrapper.requestFullscreen) elements.certificateWrapper.requestFullscreen();
        else if (elements.certificateWrapper.webkitRequestFullscreen) elements.certificateWrapper.webkitRequestFullscreen();
    }

    function closeCertificate() {
        if (document.fullscreenElement || document.webkitFullscreenElement) {
            if (document.exitFullscreen) document.exitFullscreen();
            else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
        }
        showScreen('resultArea');
    }
    
    function resetGame() {
        currentQuestionIndex = 0; score = 0;
        gameResults = []; questionsForGame = []; selectedMode = {}; userInfo = {};
        if (document.querySelectorAll('.mode-btn').length > 0) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('btn-selected-green'));
        }
        if(elements.scoreDisplay) elements.scoreDisplay.innerText = `Điểm: 0`;
        if(elements.progressBar) elements.progressBar.style.width = '0%';
        showScreen('startScreen');
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }</script></body></html>

